# ADR-005: Вибір рішення кешування

**Статус**: Прийнято  
**Дата**: 2025-08-20  
**Автор**: Стефан Костик  
**Зацікавлені сторони**: Архітектор проекту, Команда розробки, Команда операційного відділу

---

## Контекст

Система моніторингу та відстеження нагород потребує рішення кешування для покращення продуктивності часто використовуваних даних, зменшення навантаження на базу даних та підтримки управління сесіями для веб-додатка.

### Передумови
- Потреба кешувати часто використовувані дані нагород та користувачів
- Управління сесіями для автентифікованих користувачів
- Розподілене кешування для потенційного майбутнього масштабування
- Інтеграція з абстракціями кешування Spring Boot

---

## Рішення

**Redis 7+** було обрано як рішення кешування для Системи моніторингу та відстеження нагород.

### Обраний підхід
- **Кеш-движок**: Redis 7+ (остання стабільна версія)
- **Інтеграція**: Spring Data Redis з абстракцією Spring Cache
- **Конфігурація**: Один інстанс Redis для розробки, Redis Cluster для продакшену
- **Випадки використання**: Кеш додатка, сховище сесій, тимчасове зберігання даних

### Обґрунтування
- **Продуктивність**: Зберігання в пам'яті з часом відповіді менше мілісекунди
- **Інтеграція Spring**: Відмінна інтеграція Spring Boot з автоконфігурацією
- **Структури даних**: Багаті типи даних (рядки, хеші, списки, множини, відсортовані множини)
- **Персистентність**: Опціональна персистентність для довговічності даних сесій
- **Масштабованість**: Підтримка кластеризації та реплікації

---

## Наслідки

### Позитивні наслідки
- **Продуктивність**: Значне покращення швидкості доступу до даних
- **Масштабованість**: Зменшене навантаження на базу даних та покращена чутливість додатка
- **Управління сесіями**: Надійне розподілене зберігання сесій
- **Продуктивність розробки**: Просте кешування на основі анотацій з Spring

### Негативні наслідки
- **Використання пам'яті**: Додаткові вимоги до пам'яті для зберігання кешу
- **Складність**: Додатковий компонент для моніторингу та обслуговування
- **Консистентність даних**: Складність інвалідації кешу

---

## Розглянуті альтернативи

### Альтернатива 1: Hazelcast
- **Переваги**: Java-нативний, вбудований режим, розширені розподілені функції
- **Недоліки**: Складніше налаштування, більший обсяг пам'яті
- **Причина відхилення**: Надмірно для потреб проекту соло розробника

### Альтернатива 2: EhCache
- **Переваги**: Просте налаштування, JVM-локальне кешування, добре для монолітів
- **Недоліки**: Обмежені розподілені можливості, відсутність зовнішнього зберігання сесій
- **Причина відхилення**: Обмежена масштабованість для майбутнього зростання

---

## Примітки з реалізації

### Технічні вимоги
- **Версія Redis**: 7.0+ для останніх покращень продуктивності
- **Інтеграція Spring**: Spring Data Redis 3.0+
- **Пам'ять**: Мінімум 512MB, рекомендовано 2GB для продакшену
- **Персистентність**: RDB снімки для даних сесій

### Конфігурація
```yaml
spring:
  redis:
    host: localhost
    port: 6379
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
  cache:
    type: redis
    redis:
      time-to-live: 600000
```

### Стратегія кешування
- **Дані додатка**: 10-хвилинний TTL для нагород та профілів користувачів
- **Дані сесій**: Закінчення терміну дії на основі сесії
- **Статичні дані**: Довгострокове кешування для даних інституцій

---

## Метрики успіху

- **Коефіцієнт попадання в кеш**: > 80% для часто використовуваних даних
- **Час відповіді**: < 5ms для операцій кешу
- **Використання пам'яті**: < 90% виділеної пам'яті Redis

---

## Пов'язані документи

- **Технічний стек**: [Вибір технологічного стеку](../TECH_STACK_ua.md)
- **Інші ADR**: [ADR-001 Backend Framework](./ADR-001-Backend-Framework-ua.md)
- **Зовнішні ресурси**: [Документація Redis](https://redis.io/documentation)

---

## Історія версій

| **Дата** | **Автор** | **Зміни** | **Причина** |
|----------|------------|-------------|------------|
| 2025-08-20 | Стефан Костик | Початкова версія | Створення документа |

---

**Статус документа**: Затверджено  
**Дата наступного огляду**: 2026-02-20  
**Категорія ADR**: Технологія 