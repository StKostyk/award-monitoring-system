# ADR-010: Вибір testing framework

**Статус**: Прийнято  
**Дата**: 2025-08-20  
**Автор**: Стефан Костик  
**Зацікавлені сторони**: Архітектор проекту, Команда розробки, Команда QA

---

## Контекст

Система моніторингу та відстеження нагород потребує комплексних можливостей тестування, включаючи unit тести, інтеграційні тести та end-to-end тести. Тестування повинно підтримувати обраний технологічний стек та забезпечувати високе покриття коду.

### Передумови
- Unit тестування для бізнес-логіки та сервісних шарів
- Інтеграційне тестування з реальними базами даних та зовнішніми сервісами
- API тестування для REST endpoints
- Цільове покриття коду 85%+ для демонстрації портфоліо

---

## Рішення

**JUnit 5 + Testcontainers** було обрано як основний фреймворк для тестування для Системи моніторингу та відстеження нагород.

### Обраний підхід
- **Unit тестування**: JUnit 5 з Mockito для мокування
- **Інтеграційне тестування**: Testcontainers для реальної бази даних та сервісів
- **API тестування**: Spring Boot Test з MockMvc та REST Assured
- **Покриття**: JaCoCo для звітування покриття коду

### Обґрунтування
- **Сучасний framework**: JUnit 5 надає сучасні функції тестування та анотації
- **Реальне середовище**: Testcontainers дозволяють тестування з реальними базами даних
- **Інтеграція Spring**: Відмінна інтеграція Spring Boot Test
- **Промисловий стандарт**: Широко прийнятий в корпоративній Java розробці
- **Підтримка інструментів**: Відмінна підтримка IDE та інструментів збірки

---

## Наслідки

### Позитивні наслідки
- **Реальне тестування**: Інтеграційні тести з фактичною базою даних та сервісами
- **Висока впевненість**: Тести ближчі до продакшн середовища
- **Інтеграція Docker**: Консистентні тестові середовища між розробниками
- **Звітування покриття**: Комплексні метрики покриття коду

### Негативні наслідки
- **Використання ресурсів**: Docker контейнери потребують додаткової пам'яті та CPU
- **Тривалість тестів**: Інтеграційні тести повільніші за чисті unit тести
- **Крива навчання**: Конфігурація Testcontainers та найкращі практики

---

## Розглянуті альтернативи

### Альтернатива 1: TestNG
- **Переваги**: Розширена конфігурація тестів, паралельне виконання
- **Недоліки**: Менш популярний в Spring екосистемі, складніше налаштування
- **Причина відхилення**: JUnit 5 краще вписується в Spring Boot

### Альтернатива 2: Docker Compose для тестування
- **Переваги**: Простіше налаштування, спільне з середовищем розробки
- **Недоліки**: Менш гнучке, складніше управляти ізоляцією тестів
- **Причина відхилення**: Testcontainers забезпечують кращу ізоляцію тестів

---

## Примітки з реалізації

### Технічні вимоги
- **Версія JUnit**: 5.10+ для останніх функцій
- **Testcontainers**: 1.19+ з модулями PostgreSQL та Redis
- **Інструмент покриття**: JaCoCo 0.8+ для звітування покриття
- **Test Slices**: Spring Boot test slices для фокусованого тестування

### Структура тестування
```java
@SpringBootTest
@Testcontainers
class AwardServiceIntegrationTest {
    
    @Container
    static PostgreSQLContainer<?> postgres = new PostgreSQLContainer<>("postgres:17")
            .withDatabaseName("testdb")
            .withUsername("test")
            .withPassword("test");
    
    @Container
    static GenericContainer<?> redis = new GenericContainer<>("redis:7-alpine")
            .withExposedPorts(6379);
    
    @Test
    void shouldCreateAward() {
        // Реалізація інтеграційного тесту
    }
}
```

### Категорії тестів
- **Unit тести**: Логіка сервісного шару з замокованими залежностями
- **Інтеграційні тести**: Операції бази даних з Testcontainers
- **API тести**: REST endpoints з MockMvc
- **Contract тести**: Верифікація контрактів API

---

## Метрики успіху

- **Покриття коду**: > 85% загального покриття
- **Час виконання тестів**: < 5 хвилин для повного набору тестів
- **Надійність тестів**: < 1% нестабільних тестів

---

## Пов'язані документи

- **Технічний стек**: [Вибір технологічного стеку](../TECH_STACK_ua.md)
- **Інші ADR**: [ADR-004 База даних](./ADR-004-Database-ua.md)
- **Зовнішні ресурси**: [Документація JUnit 5](https://junit.org/junit5/docs/current/user-guide/)

---

## Історія версій

| **Дата** | **Автор** | **Зміни** | **Причина** |
|----------|------------|-------------|------------|
| 2025-08-20 | Стефан Костик | Початкова версія | Створення документа |

---

**Статус документа**: Затверджено  
**Дата наступного огляду**: 2026-02-20  
**Категорія ADR**: Технологія 