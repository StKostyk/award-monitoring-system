# Quality Gates та Definition of Done
## Система моніторингу та відстеження нагород

> **Результат Фази 11**: Управління проєктом та Agile-фреймворк  
> **Версія документа**: 1.0  
> **Останнє оновлення**: Грудень 2025  
> **Автор**: Стефан Костик  
> **Ціль якості**: Стандарти корпоративного рівня для демонстрації портфоліо

---

## Короткий огляд

Цей документ визначає quality gates та критерії Definition of Done (DoD), які забезпечують послідовні, високоякісні результати протягом усієї розробки Системи моніторингу та відстеження нагород. Ці стандарти демонструють практики старшого розробника, придатні для корпоративних середовищ.

---

## 1. Definition of Done (DoD)

### 1.1 DoD користувацької історії

Користувацька історія вважається **Завершеною**, коли ВСІ критерії виконано:

#### Якість коду
- [ ] Код відповідає стандартам кодування проєкту
- [ ] Самостійно перевірено на зрозумілість та підтримуваність
- [ ] Немає попереджень компілятора або помилок лінтера
- [ ] Статичний аналіз пройдено (SonarQube)
- [ ] Покриття коду ≥85% для нового коду
- [ ] Немає нових критичних/блокуючих проблем

#### Тестування
- [ ] Модульні тести написані та проходять
- [ ] Інтеграційні тести написані та проходять
- [ ] API-тести проходять (якщо застосовно)
- [ ] Ручне тестування завершено
- [ ] Граничні випадки покриті

#### Безпека
- [ ] Перевірка безпеки завершена
- [ ] Немає критичних вразливостей (перевірка OWASP)
- [ ] Автентифікація/авторизація перевірена
- [ ] Валідація вводу реалізована

#### Документація
- [ ] Коментарі коду для складної логіки
- [ ] Документація API оновлена (OpenAPI)
- [ ] README оновлено за потреби
- [ ] Запис в CHANGELOG додано

#### Відповідність
- [ ] Вимоги GDPR перевірені (якщо обробляються персональні дані)
- [ ] Доступність перевірена (WCAG AA)
- [ ] Продуктивність в межах SLA (<200мс відповідь API)

### 1.2 DoD завдання (технічні завдання)

- [ ] Реалізація завершена
- [ ] Модульні тести проходять
- [ ] Код перевірено
- [ ] Інтегровано з гілкою develop
- [ ] Збірка проходить в CI

### 1.3 DoD виправлення бага

- [ ] Кореневу причину ідентифіковано
- [ ] Виправлення реалізовано
- [ ] Регресійний тест додано
- [ ] Суміжні області протестовано
- [ ] Нових багів не введено

---

## 2. Quality Gates

### 2.1 Quality Gate спринту

**Перед завершенням спринту:**

| **Категорія** | **Критерій** | **Поріг** | **Дія при невдачі** |
|---------------|--------------|-----------|---------------------|
| Історії | DoD виконано для зобов'язаних історій | 100% | Перенести незавершені |
| Баги | Немає відкритих критичних багів | 0 критичних | Виправити перед закриттям |
| Покриття | Покриття нового коду | ≥85% | Додати тести |
| Безпека | Немає нових вразливостей | 0 high/critical | Виправити негайно |
| Збірка | CI пайплайн проходить | Зелений | Виправити перед мержем |

### 2.2 Quality Gates віх

#### Віха 1: Фундамент завершено (Спринт 4)

| **Gate** | **Критерій** | **Доказ** |
|----------|--------------|-----------|
| Інфраструктура | Всі сервіси працюють | Docker compose up |
| Auth | Вхід/вихід працює | Звіт покриття тестами |
| База даних | Міграції застосовано | Історія Flyway |
| CI/CD | Пайплайн автоматизовано | Логи GitHub Actions |
| Покриття | Загальне ≥80% | Дашборд SonarQube |

#### Віха 2: Основний MVP (Спринт 8)

| **Gate** | **Критерій** | **Доказ** |
|----------|--------------|-----------|
| Потік нагород | Подати → Затвердити → Відобразити | E2E тест проходить |
| Workflow | Багаторівневе затвердження працює | Тестові сценарії |
| UI | Базові форми працюють | Ручне тестування |
| API | Основні ендпоінти задокументовані | OpenAPI специфікація |
| Безпека | RBAC примусово застосовано | Тести дозволів |

#### Віха 3: Функції завершено (Спринт 12)

| **Gate** | **Критерій** | **Доказ** |
|----------|--------------|-----------|
| Аналітика | Дашборди працюють | Скріншоти |
| GDPR | Експорт/видалення працює | Докази тестування |
| Мобільна | Адаптивний дизайн | Тестування на пристроях |
| Сповіщення | Email/in-app працює | Логи тестів |
| Доступність | Відповідність WCAG AA | Звіт аудиту |

#### Віха 4: Готовність до продакшену (Спринт 16)

| **Gate** | **Критерій** | **Доказ** |
|----------|--------------|-----------|
| Продуктивність | <200мс P99 відповідь | Звіт навантажувального тесту |
| Безпека | Тест на проникнення пройдено | Звіт безпеки |
| Документація | Повна та актуальна | Перевірка документації |
| Розгортання | K8s маніфести готові | Тест розгортання |
| Моніторинг | Алерти налаштовані | Дашборд Grafana |

---

## 3. Стандарти якості коду

### 3.1 Quality Gate SonarQube

```yaml
quality_gate:
  coverage:
    minimum: 85%
    on_new_code: 85%
  
  duplications:
    maximum: 3%
  
  maintainability:
    rating: A
    debt_ratio: <5%
  
  reliability:
    rating: A
    bugs: 0 (blocker/critical)
  
  security:
    rating: A
    vulnerabilities: 0 (blocker/critical)
    hotspots_reviewed: 100%
```

### 3.2 Чек-лист код-рев'ю

**Самоперевірка перед комітом:**

- [ ] **Коректність**: Чи робить код те, що повинен?
- [ ] **Читабельність**: Чи легко зрозуміти?
- [ ] **Простота**: Чи є простіший підхід?
- [ ] **Тестування**: Чи покриті граничні випадки?
- [ ] **Безпека**: Чи є потенційні вразливості?
- [ ] **Продуктивність**: Чи є очевидні неефективності?
- [ ] **Стандарти**: Чи відповідає конвенціям проєкту?

### 3.3 Зведення стандартів кодування

| **Аспект** | **Стандарт** |
|------------|--------------|
| Стиль Java | Google Java Style Guide |
| Іменування | Описове, англійською, camelCase/PascalCase |
| Коментарі | Javadoc для публічних API |
| Складність | Цикломатична складність ≤10 |
| Довжина методу | ≤30 рядків бажано |
| Довжина класу | ≤500 рядків бажано |

---

## 4. Стандарти тестування

### 4.1 Цільові показники піраміди тестів

```
        ┌─────────┐
        │   E2E   │  5-10% тестів
        │  тести  │  Selenium/Playwright
        ├─────────┤
        │ Інтегра-│  20-30% тестів
        │  ційні  │  TestContainers, REST Assured
        ├─────────┤
        │Модульні │  60-70% тестів
        │  тести  │  JUnit 5, Mockito
        └─────────┘
```

### 4.2 Вимоги до покриття тестами

| **Шар** | **Мінімальне покриття** | **Фокус** |
|---------|-------------------------|-----------|
| Сервісний шар | 90% | Бізнес-логіка |
| Шар контролерів | 85% | Обробка запитів |
| Шар репозиторіїв | 80% | Доступ до даних |
| Домен/Сутності | 75% | Правила валідації |
| Утилітні класи | 95% | Граничні випадки |

### 4.3 Конвенція іменування тестів

```java
// Шаблон: methodName_condition_expectedResult
@Test
void createAward_validInput_returnsCreatedAward() { }

@Test
void createAward_nullTitle_throwsValidationException() { }

@Test
void approveAward_insufficientPermissions_returnsForbidden() { }
```

---

## 5. Quality Gates безпеки

### 5.1 Чек-лист безпеки (для кожної функції)

- [ ] Валідація вводу для всіх користувацьких вводів
- [ ] Кодування виводу для запобігання XSS
- [ ] Запобігання SQL-ін'єкціям (параметризовані запити)
- [ ] Автентифікація вимагається для захищених ендпоінтів
- [ ] Авторизація перевіряється для дій користувача
- [ ] Чутливі дані зашифровані
- [ ] Журналювання аудиту для подій безпеки
- [ ] Обмеження швидкості де доречно

### 5.2 Графік сканування безпеки

| **Інструмент** | **Частота** | **Дія при знахідках** |
|----------------|-------------|----------------------|
| OWASP Dependency Check | Кожна збірка | Блокувати при критичних |
| SonarQube Security | Кожна збірка | Переглянути hotspots |
| Ручний огляд | Кожен спринт | Задокументувати знахідки |

---

## 6. Quality Gates продуктивності

### 6.1 Порогові значення продуктивності

| **Метрика** | **Ціль** | **Максимум** |
|-------------|----------|--------------|
| Відповідь API (P50) | <100мс | 150мс |
| Відповідь API (P99) | <200мс | 500мс |
| Час завантаження сторінки | <2с | 3с |
| Запит до БД | <50мс | 100мс |
| Пропускна здатність | >100 req/s | - |

### 6.2 Gates навантажувального тестування (перед продакшеном)

| **Сценарій** | **Навантаження** | **Критерії успіху** |
|--------------|------------------|---------------------|
| Нормальне навантаження | 50 одночасних | <200мс P99, 0% помилок |
| Пікове навантаження | 200 одночасних | <500мс P99, <1% помилок |
| Стрес-тест | 500 одночасних | Плавна деградація |
| Тест витривалості | 50 одночасних, 1 година | Без витоків пам'яті |

---

## 7. Quality Gates документації

### 7.1 Вимоги до документації

| **Документ** | **Потрібен до** | **Критерії перегляду** |
|--------------|-----------------|------------------------|
| Специфікація API (OpenAPI) | Кожен API | Повна, з прикладами |
| Коментарі коду | Складна логіка | Зрозумілі, актуальні |
| README | Кожна віха | Інструкції налаштування працюють |
| CHANGELOG | Кожен реліз | Всі зміни перелічені |
| Посібник користувача | Функції завершено | Орієнтований на завдання |

### 7.2 Чек-лист документації API

- [ ] Всі ендпоінти задокументовані
- [ ] Схеми запитів/відповідей визначені
- [ ] Відповіді помилок задокументовані
- [ ] Вимоги автентифікації вказані
- [ ] Приклади запитів надані
- [ ] Згенеровано з коду (OpenAPI)

---

## 8. Quality Gates доступності

### 8.1 Чек-лист WCAG AA

| **Принцип** | **Вимога** | **Метод тестування** |
|-------------|------------|----------------------|
| Сприйнятливість | Alt-текст для зображень | Автоматизовано + вручну |
| Сприйнятливість | Контраст кольорів ≥4.5:1 | Автоматизовано |
| Керованість | Навігація клавіатурою | Ручне тестування |
| Керованість | Без обмежень часу або попередження | Перегляд |
| Зрозумілість | Послідовна навігація | Ручний огляд |
| Надійність | Валідний HTML | Автоматизована валідація |

### 8.2 Тестування доступності

- [ ] Сканування axe-core проходить
- [ ] Навігація тільки клавіатурою протестована
- [ ] Тестування зі screen reader (NVDA/VoiceOver)
- [ ] Контраст кольорів перевірено
- [ ] Індикатори фокусу видимі

---

## 9. Дашборд метрик якості

### 9.1 Метрики для відстеження

| **Категорія** | **Метрика** | **Ціль** | **Інструмент** |
|---------------|-------------|----------|----------------|
| Код | Покриття | ≥85% | SonarQube |
| Код | Дублювання | <3% | SonarQube |
| Код | Коефіцієнт тех. боргу | <5% | SonarQube |
| Безпека | Вразливості | 0 критичних | OWASP/Sonar |
| Тестування | Відсоток проходження тестів | 100% | JUnit |
| Продуктивність | Затримка P99 | <200мс | JMeter |
| Надійність | Успішність збірок | >95% | GitHub Actions |

### 9.2 Огляд трендів якості

Переглядати щотижня:
- Тренд покриття (покращується?)
- Тренд тех. боргу (стабільний або зменшується?)
- Рівень появи багів (зменшується?)
- Стабільність збірок (>95%?)

---

## Підсумок

| **Тип Gate** | **Ключові критерії** |
|--------------|---------------------|
| **DoD історії** | Тести, покриття, безпека, документація |
| **Gate спринту** | Всі історії завершені, немає критичних багів |
| **Gate віхи** | Функції завершені, метрики якості досягнуті |
| **Gate релізу** | Продуктивність, безпека, доступність перевірені |

**Філософія якості**: Вбудовуйте якість з самого початку. Кожен коміт повинен бути потенційно релізним.

---

**Версія документа**: 1.0  
**Створено**: Грудень 2025  
**Наступний перегляд**: Кінець спринту 1 (калібрування порогів)

