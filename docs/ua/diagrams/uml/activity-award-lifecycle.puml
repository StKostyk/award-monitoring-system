@startuml Activity_Award_Lifecycle_UA
!theme plain
skinparam activityShape octagon

title Життєвий Цикл Нагороди - Діаграма Діяльності

||#LightBlue|Працівник|
||#LightGreen|Секретар Факультету|
||#LightYellow|Декан|
||#LightCoral|Ректорат|
||#LightGray|Система|

||Працівник|
start
:Доступ до Системи Нагород;
:Створити Чернетку Нагороди;

repeat
    :Заповнити Деталі Нагороди;
    :Завантажити Сертифікат;
    
    |Система|
    :ШІ Парсинг Документа;
    
    if (Впевненість >= 80%?) then (так)
        :Автозаповнити Метадані;
    else (ні)
        :Позначити для Ручного Введення;
    endif
    
    |Працівник|
    :Переглянути/Редагувати Деталі;
    
    if (Зберегти як Чернетку?) then (так)
        :Зберегти Чернетку;
        stop
    else (ні)
        :Подати Нагороду;
    endif
    
    |Система|
    :Валідувати Подання;
    
repeat while (Помилки Валідації?) is (так)
->ні;

||Система|
:Визначити Рівень Нагороди;
:Створити Запит на Рецензування;

switch (Рівень Нагороди?)
case (Кафедра/Факультет)
    :Призначити Секретарю Факультету;
case (Університет+)
    :Призначити Секретарю Факультету\n(Перший Рівень);
endswitch

||Секретар Факультету|
:Отримати Сповіщення про Рецензування;
:Відкрити Нагороду для Рецензування;
:Перевірити Сертифікат та Деталі;

if (Нагорода Валідна?) then (так)
    if (В Межах Повноважень?) then (так)
        :Схвалити Нагороду;
        |Система|
        :Оновити Статус = СХВАЛЕНО;
        :Опублікувати Нагороду;
        |Працівник|
        :Отримати Сповіщення про Схвалення;
        :Нагорода Публічно Видима;
        stop
    else (ні - потрібна ескалація)
        :Ескалювати до Декана;
        |Система|
        :Оновити Рецензента = Декан;
        
        |Декан|
        :Отримати Сповіщення про Рецензування;
        :Рецензувати Нагороду;
        
        if (Схвалює?) then (так)
            if (В Межах Повноважень?) then (так)
                :Схвалити Нагороду;
                |Система|
                :Оновити Статус = СХВАЛЕНО;
                :Опублікувати Нагороду;
                |Працівник|
                :Отримати Сповіщення про Схвалення;
                stop
            else (ні - рівень університету)
                :Рекомендувати Схвалення;
                :Передати до Ректорату;
                |Система|
                :Оновити Рецензента = Секретар Ректора;
                
                |Ректорат|
                :Отримати Сповіщення про Рецензування;
                :Рецензувати Нагороду;
                
                if (Схвалює?) then (так)
                    if (Секретар Може Схвалити?) then (так)
                        :Секретар Схвалює;
                    else (ні - потрібен Ректор)
                        :Ескалювати до Ректора;
                        :Ректор Рецензує;
                        :Ректор Схвалює;
                    endif
                    |Система|
                    :Оновити Статус = СХВАЛЕНО;
                    :Опублікувати Нагороду;
                    |Працівник|
                    :Отримати Сповіщення про Схвалення;
                    stop
                else (ні)
                    :Відхилити Нагороду;
                    |Система|
                    :Оновити Статус = ВІДХИЛЕНО;
                    |Працівник|
                    :Отримати Сповіщення про Відхилення;
                    
                    if (Повторне Подання?) then (так)
                        :Редагувати Нагороду;
                        |Система|
                        :Скинути до Чернетки;
                        ->Подати Нагороду;
                    else (ні)
                        stop
                    endif
                endif
            endif
        else (ні)
            :Відхилити Нагороду;
            |Система|
            :Оновити Статус = ВІДХИЛЕНО;
            |Працівник|
            :Отримати Сповіщення про Відхилення;
            
            if (Повторне Подання?) then (так)
                :Редагувати Нагороду;
                |Система|
                :Скинути до Чернетки;
                ->Подати Нагороду;
            else (ні)
                stop
            endif
        endif
    endif
else (ні - невалідна)
    if (Потрібні Виправлення?) then (так)
        :Повернути на Виправлення;
        |Система|
        :Оновити Статус = ПОВЕРНУТО;
        |Працівник|
        :Отримати Сповіщення про Повернення;
        :Внести Виправлення;
        |Система|
        :Скинути до На Рецензуванні;
        |Секретар Факультету|
        ->Відкрити Нагороду для Рецензування;
    else (ні - відхилити)
        :Відхилити Нагороду;
        |Система|
        :Оновити Статус = ВІДХИЛЕНО;
        |Працівник|
        :Отримати Сповіщення про Відхилення;
        
        if (Повторне Подання?) then (так)
            :Редагувати Нагороду;
            |Система|
            :Скинути до Чернетки;
            ->Подати Нагороду;
        else (ні)
            stop
        endif
    endif
endif

@enduml


