@startuml Deployment_Template_UA
' =============================================================================
' Шаблон Діаграми Розгортання
' Система Моніторингу та Відстеження Нагород
' =============================================================================
' Використання: Скопіюйте цей шаблон для документації інфраструктури
' Найкраще для: Продакшн топологія, хмарна архітектура, мережева структура
' =============================================================================

!theme plain

' =============================================================================
' СТИЛІЗАЦІЯ ВУЗЛІВ
' =============================================================================
skinparam node {
    BackgroundColor<<cloud>> LightBlue
    BackgroundColor<<container>> LightGreen
    BackgroundColor<<database>> LightYellow
    BackgroundColor<<external>> Pink
    BackgroundColor<<security>> LightCoral
}

title [Назва Середовища] - Діаграма Розгортання

' =============================================================================
' ХМАРА/ІНТЕРНЕТ
' =============================================================================
cloud "Інтернет" as internet {
    actor "Користувачі" as users
}

' =============================================================================
' РІВЕНЬ БЕЗПЕКИ
' =============================================================================
node "CDN / WAF" <<security>> as cdn {
    component [CloudFlare\nЗахист від DDoS] as waf
}

' =============================================================================
' БАЛАНСУВАЛЬНИК НАВАНТАЖЕННЯ
' =============================================================================
node "Балансувальник Навантаження" <<cloud>> as lb {
    component [HAProxy/ALB\nПеревірка Здоров'я] as haproxy
}

' =============================================================================
' КЛАСТЕР ДОДАТКІВ
' =============================================================================
node "Kubernetes Кластер" <<cloud>> as k8s {
    
    ' Frontend
    node "Frontend Простір Імен" <<container>> as frontend_ns {
        artifact "web-app-pod-1" as web1
        artifact "web-app-pod-2" as web2
    }
    
    ' Backend Сервіси
    node "Простір Імен Сервісів" <<container>> as services_ns {
        frame "Розгортання Сервісу" {
            artifact "service-pod-1" as svc1
            artifact "service-pod-2" as svc2
        }
    }
    
    ' Рівень Даних
    node "Простір Імен Даних" <<database>> as data_ns {
        database "PostgreSQL" as postgres {
            artifact "postgres-primary" as pg_primary
            artifact "postgres-replica" as pg_replica
        }
        
        database "Redis" as redis {
            artifact "redis-master" as redis_m
        }
        
        queue "Kafka" as kafka {
            artifact "kafka-broker" as kafka_b
        }
    }
    
    ' Моніторинг
    node "Простір Імен Моніторингу" <<container>> as monitoring {
        component [Prometheus] as prom
        component [Grafana] as grafana
    }
}

' =============================================================================
' ЗОВНІШНІ СЕРВІСИ
' =============================================================================
node "Зовнішні Сервіси" <<external>> as external {
    component [LDAP/AD] as ldap
    component [Хмарний ШІ] as ai
    component [Email/SMS] as comm
    component [Об'єктне Сховище] as storage
}

' =============================================================================
' ПЕРСИСТЕНТНЕ СХОВИЩЕ
' =============================================================================
storage "Персистентні Томи" as pv {
    artifact [database-pv]
    artifact [storage-pv]
}

' =============================================================================
' З'ЄДНАННЯ
' =============================================================================
' Трафік користувачів
users --> waf : HTTPS (443)
waf --> haproxy : HTTPS
haproxy --> web1 : HTTP (80)
haproxy --> web2 : HTTP (80)

' Комунікація сервісів
web1 --> svc1 : HTTP (8080)
svc1 --> pg_primary : TCP (5432)
svc1 --> redis_m : TCP (6379)
svc1 --> kafka_b : TCP (9092)

' Зовнішні інтеграції
svc1 --> ldap : LDAPS (636)
svc1 --> ai : HTTPS (443)
svc1 --> comm : HTTPS (443)
svc1 --> storage : HTTPS (443)

' Моніторинг
prom --> svc1 : /actuator (9090)

' Сховище
pg_primary --> pv

' =============================================================================
' ПРИМІТКИ
' =============================================================================
note bottom of k8s
    Kubernetes Ресурси:
    - HPA (Горизонтальне Автомасштабування Подів)
    - PDB (Бюджет Порушення Подів)
    - Мережеві Політики
    - Квоти Ресурсів
    - Управління Секретами
end note

note right of postgres
    Конфігурація Бази Даних:
    - Primary + Read Репліка
    - Потокова Реплікація
    - Щоденні Резервні Копії
    - Відновлення на Момент Часу
end note

note right of external
    Зовнішні Залежності:
    - Університетський LDAP (Аутентифікація)
    - Azure AI (OCR Документів)
    - SendGrid (Email)
    - AWS S3 (Сховище)
end note

@enduml


