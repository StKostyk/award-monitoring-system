@startuml C4_Code
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Award Monitoring & Tracking System - Code Diagram (C4 Level 4) - Award Module

LAYOUT_LEFT_RIGHT()

' Note: This diagram shows the internal structure of the Award Module
' focusing on key classes and their relationships

package "Award Module" {
    
    ' Controller Layer
    package "Controller" <<Rectangle>> {
        class AwardController {
            -awardService: AwardService
            +createAward(request: AwardCreateRequest): AwardResponse
            +getAward(id: Long): AwardResponse
            +updateAward(id: Long, request: AwardUpdateRequest): AwardResponse
            +submitAward(id: Long): AwardResponse
            +listAwards(filter: AwardFilter, pageable: Pageable): Page<AwardResponse>
            +getMyAwards(pageable: Pageable): Page<AwardResponse>
        }
        
        class AwardDocumentController {
            -documentService: DocumentService
            +uploadDocument(awardId: Long, file: MultipartFile): DocumentResponse
            +getDocument(documentId: Long): DocumentResponse
            +deleteDocument(documentId: Long): void
        }
    }
    
    ' Service Layer
    package "Service" <<Rectangle>> {
        interface AwardService {
            +createAward(command: CreateAwardCommand): Award
            +updateAward(command: UpdateAwardCommand): Award
            +submitAward(awardId: Long, userId: Long): Award
            +getAward(awardId: Long): Award
            +findAwards(filter: AwardFilter, pageable: Pageable): Page<Award>
            +findByUser(userId: Long, pageable: Pageable): Page<Award>
        }
        
        class AwardServiceImpl {
            -awardRepository: AwardRepository
            -userService: UserService
            -workflowEngine: WorkflowEngine
            -eventPublisher: EventPublisher
            -auditService: AuditService
            -validator: AwardValidator
        }
        
        class AwardValidator {
            +validateCreate(command: CreateAwardCommand): void
            +validateUpdate(command: UpdateAwardCommand): void
            +validateSubmit(award: Award): void
            -checkDuplicates(award: Award): void
            -validateDates(award: Award): void
        }
        
        interface DocumentService {
            +uploadDocument(awardId: Long, file: MultipartFile): Document
            +processDocument(documentId: Long): ParsedMetadata
            +getDocument(documentId: Long): Document
            +deleteDocument(documentId: Long): void
        }
    }
    
    ' Domain Layer
    package "Domain" <<Rectangle>> {
        class Award <<Entity>> {
            -id: Long
            -userId: Long
            -categoryId: Long
            -title: String
            -description: String
            -awardingOrganization: String
            -awardDate: LocalDate
            -status: AwardStatus
            -verificationBadge: Boolean
            -impactScore: Integer
            -createdAt: Instant
            -updatedAt: Instant
            -version: Long
            +submit(): void
            +approve(): void
            +reject(reason: String): void
            +archive(): void
        }
        
        enum AwardStatus <<Enumeration>> {
            DRAFT
            PENDING
            APPROVED
            REJECTED
            ARCHIVED
        }
        
        class AwardCategory <<Entity>> {
            -id: Long
            -name: String
            -description: String
            -level: RecognitionLevel
        }
        
        enum RecognitionLevel <<Enumeration>> {
            DEPARTMENT
            FACULTY
            UNIVERSITY
            NATIONAL
            INTERNATIONAL
        }
        
        class Document <<Entity>> {
            -id: Long
            -awardId: Long
            -filePath: String
            -fileName: String
            -fileType: String
            -fileSize: Long
            -storageUrl: String
            -parsedMetadata: JsonNode
            -confidenceScore: Double
            -status: DocumentStatus
            -uploadedAt: Instant
            -processedAt: Instant
        }
        
        enum DocumentStatus <<Enumeration>> {
            UPLOADING
            UPLOADED
            PROCESSING
            PROCESSED
            VERIFIED
            ARCHIVED
        }
    }
    
    ' Repository Layer
    package "Repository" <<Rectangle>> {
        interface AwardRepository {
            +findById(id: Long): Optional<Award>
            +findByUserId(userId: Long, pageable: Pageable): Page<Award>
            +findByStatus(status: AwardStatus, pageable: Pageable): Page<Award>
            +findByOrganizationId(orgId: Long, pageable: Pageable): Page<Award>
            +existsByUserIdAndTitleAndAwardDate(userId: Long, title: String, date: LocalDate): boolean
            +save(award: Award): Award
            +delete(award: Award): void
        }
        
        interface DocumentRepository {
            +findById(id: Long): Optional<Document>
            +findByAwardId(awardId: Long): List<Document>
            +save(document: Document): Document
            +delete(document: Document): void
        }
    }
    
    ' DTO Layer
    package "DTO" <<Rectangle>> {
        class AwardCreateRequest {
            +title: String
            +description: String
            +categoryId: Long
            +awardingOrganization: String
            +awardDate: LocalDate
        }
        
        class AwardResponse {
            +id: Long
            +title: String
            +description: String
            +category: AwardCategoryDto
            +awardingOrganization: String
            +awardDate: LocalDate
            +status: AwardStatus
            +verificationBadge: Boolean
            +owner: UserSummaryDto
            +documents: List<DocumentSummaryDto>
            +createdAt: Instant
        }
        
        class CreateAwardCommand {
            +userId: Long
            +title: String
            +description: String
            +categoryId: Long
            +awardingOrganization: String
            +awardDate: LocalDate
        }
    }
    
    ' Event Layer
    package "Events" <<Rectangle>> {
        class AwardCreatedEvent <<DomainEvent>> {
            +awardId: Long
            +userId: Long
            +title: String
            +categoryId: Long
            +timestamp: Instant
        }
        
        class AwardSubmittedEvent <<DomainEvent>> {
            +awardId: Long
            +userId: Long
            +requestId: Long
            +timestamp: Instant
        }
        
        class AwardApprovedEvent <<DomainEvent>> {
            +awardId: Long
            +approverId: Long
            +level: String
            +timestamp: Instant
        }
    }
}

' Relationships
AwardController --> AwardService : uses
AwardController ..> AwardCreateRequest : receives
AwardController ..> AwardResponse : returns
AwardDocumentController --> DocumentService : uses

AwardServiceImpl ..|> AwardService : implements
AwardServiceImpl --> AwardRepository : uses
AwardServiceImpl --> AwardValidator : uses
AwardServiceImpl ..> CreateAwardCommand : uses
AwardServiceImpl ..> AwardCreatedEvent : publishes
AwardServiceImpl ..> AwardSubmittedEvent : publishes

AwardValidator --> AwardRepository : uses

Award --> AwardStatus : has
Award --> AwardCategory : belongs to
AwardCategory --> RecognitionLevel : has
Document --> DocumentStatus : has
Document --> Award : belongs to

AwardRepository ..> Award : manages
DocumentRepository ..> Document : manages

AwardResponse ..> Award : maps from
CreateAwardCommand ..> AwardCreateRequest : from

@enduml



